{"version":3,"sources":["webpack:///./src/ItemList.jsx"],"names":["ItemList","React","Component","fetchData","match","search","showError","params","URLSearchParams","vars","get","category","priceMin","parseFloat","Number","isNaN","priceMax","query","data","graphQLFetch","constructor","items","store","initialData","itemList","state","toastVisible","toastMessage","toastType","closeItem","bind","deleteItem","showSuccess","dismissToast","componentDidMount","loadData","componentDidUpdate","prevProps","location","prevSearch","props","setState","index","pathname","history","id","itemDelete","prevState","newList","push","splice","message","render","path","ItemDetail"],"mappings":";;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEe,MAAMA,QAAN,SAAuBC,4CAAK,CAACC,SAA7B,CAAuC;AAC9B,eAATC,SAAS,CAACC,KAAD,EAAQC,MAAR,EAAgBC,SAAhB,EAA2B;AAC/C,UAAMC,MAAM,GAAG,IAAIC,wDAAJ,CAAoBH,MAApB,CAAf;AACA,UAAMI,IAAI,GAAG,EAAb;AACA,QAAIF,MAAM,CAACG,GAAP,CAAW,UAAX,CAAJ,EAA4BD,IAAI,CAACE,QAAL,GAAgBJ,MAAM,CAACG,GAAP,CAAW,UAAX,CAAhB;AAE5B,UAAME,QAAQ,GAAGC,UAAU,CAACN,MAAM,CAACG,GAAP,CAAW,UAAX,CAAD,EAAyB,EAAzB,CAA3B;AACA,QAAI,CAACI,MAAM,CAACC,KAAP,CAAaH,QAAb,CAAL,EAA6BH,IAAI,CAACG,QAAL,GAAgBA,QAAhB;AAC7B,UAAMI,QAAQ,GAAGH,UAAU,CAACN,MAAM,CAACG,GAAP,CAAW,UAAX,CAAD,EAAyB,EAAzB,CAA3B;AACA,QAAI,CAACI,MAAM,CAACC,KAAP,CAAaC,QAAb,CAAL,EAA6BP,IAAI,CAACO,QAAL,GAAgBA,QAAhB;AAE7B,UAAMC,KAAK,GAAI;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAbI;AAeA,UAAMC,IAAI,GAAG,MAAMC,gEAAY,CAACF,KAAD,EAAQR,IAAR,EAAcH,SAAd,CAA/B;AACA,WAAOY,IAAP;AACD;;AAEDE,aAAW,GAAG;AACZ;AACA,UAAMC,KAAK,GAAGC,iDAAK,CAACC,WAAN,GAAoBD,iDAAK,CAACC,WAAN,CAAkBC,QAAtC,GAAiD,IAA/D;AACA,WAAOF,iDAAK,CAACC,WAAb;AACA,SAAKE,KAAL,GAAa;AACXJ,WADW;AAEXK,kBAAY,EAAE,KAFH;AAGXC,kBAAY,EAAE,EAHH;AAIXC,eAAS,EAAE;AAJA,KAAb;AAMA,SAAKC,SAAL,GAAiB,KAAKA,SAAL,CAAeC,IAAf,CAAoB,IAApB,CAAjB;AACA,SAAKC,UAAL,GAAkB,KAAKA,UAAL,CAAgBD,IAAhB,CAAqB,IAArB,CAAlB;AACA,SAAKE,WAAL,GAAmB,KAAKA,WAAL,CAAiBF,IAAjB,CAAsB,IAAtB,CAAnB;AACA,SAAKxB,SAAL,GAAiB,KAAKA,SAAL,CAAewB,IAAf,CAAoB,IAApB,CAAjB;AACA,SAAKG,YAAL,GAAoB,KAAKA,YAAL,CAAkBH,IAAlB,CAAuB,IAAvB,CAApB;AACD;;AAEDI,mBAAiB,GAAG;AAClB,UAAM;AAAEb;AAAF,QAAY,KAAKI,KAAvB;AACA,QAAIJ,KAAK,IAAI,IAAb,EAAmB,KAAKc,QAAL;AACpB;;AAEDC,oBAAkB,CAACC,SAAD,EAAY;AAC5B,UAAM;AAAEC,cAAQ,EAAE;AAAEjC,cAAM,EAAEkC;AAAV;AAAZ,QAAuCF,SAA7C;AACA,UAAM;AAAEC,cAAQ,EAAE;AAAEjC;AAAF;AAAZ,QAA2B,KAAKmC,KAAtC;;AACA,QAAID,UAAU,KAAKlC,MAAnB,EAA2B;AACzB,WAAK8B,QAAL;AACD;AACF;;AAEa,QAARA,QAAQ,GAAG;AACf,UAAM;AAAEG,cAAQ,EAAE;AAAEjC;AAAF;AAAZ,QAA2B,KAAKmC,KAAtC;AACA,UAAMtB,IAAI,GAAG,MAAMlB,QAAQ,CAACG,SAAT,CAAmB,IAAnB,EAAyBE,MAAzB,EAAiC,KAAKC,SAAtC,CAAnB;;AACA,QAAIY,IAAJ,EAAU;AACR,WAAKuB,QAAL,CAAc;AAAEpB,aAAK,EAAEH,IAAI,CAACM;AAAd,OAAd;AACD;AACF;;AAEe,QAAVO,UAAU,CAACW,KAAD,EAAQ;AACtB,UAAMzB,KAAK,GAAI;AACnB;AACA,MAFI;AAGA,UAAM;AAAEI;AAAF,QAAY,KAAKI,KAAvB;AACA,UAAM;AAAEa,cAAQ,EAAE;AAAEK,gBAAF;AAAYtC;AAAZ,OAAZ;AAAkCuC;AAAlC,QAA8C,KAAKJ,KAAzD;AACA,UAAM;AAAEK;AAAF,QAASxB,KAAK,CAACqB,KAAD,CAApB;AACA,UAAMxB,IAAI,GAAG,MAAMC,gEAAY,CAACF,KAAD,EAAQ;AAAE4B;AAAF,KAAR,EAAgB,KAAKvC,SAArB,CAA/B;;AACA,QAAIY,IAAI,IAAIA,IAAI,CAAC4B,UAAjB,EAA6B;AAC3B,WAAKL,QAAL,CAAeM,SAAD,IAAe;AAC3B,cAAMC,OAAO,GAAG,CAAC,GAAGD,SAAS,CAAC1B,KAAd,CAAhB;;AACA,YAAIsB,QAAQ,KAAM,UAASE,EAAG,EAA9B,EAAiC;AAC/BD,iBAAO,CAACK,IAAR,CAAa;AAAEN,oBAAQ,EAAE,QAAZ;AAAsBtC;AAAtB,WAAb;AACD;;AACD2C,eAAO,CAACE,MAAR,CAAeR,KAAf,EAAsB,CAAtB;AACA,eAAO;AAAErB,eAAK,EAAE2B;AAAT,SAAP;AACD,OAPD;AAQA,WAAKhB,WAAL,CAAkB,gBAAea,EAAG,gBAApC;AACD,KAVD,MAUO;AACL,WAAKV,QAAL;AACD;AACF;;AAEDH,aAAW,CAACmB,OAAD,EAAU;AACnB,SAAKV,QAAL,CAAc;AACZf,kBAAY,EAAE,IADF;AACQC,kBAAY,EAAEwB,OADtB;AAC+BvB,eAAS,EAAE;AAD1C,KAAd;AAGD;;AAEDtB,WAAS,CAAC6C,OAAD,EAAU;AACjB,SAAKV,QAAL,CAAc;AACZf,kBAAY,EAAE,IADF;AACQC,kBAAY,EAAEwB,OADtB;AAC+BvB,eAAS,EAAE;AAD1C,KAAd;AAGD;;AAEDK,cAAY,GAAG;AACb,SAAKQ,QAAL,CAAc;AAAEf,kBAAY,EAAE;AAAhB,KAAd;AACD;;AAED0B,QAAM,GAAG;AACP,UAAM;AAAE/B;AAAF,QAAY,KAAKI,KAAvB;AACA,QAAIJ,KAAK,IAAI,IAAb,EAAmB,OAAO,IAAP;AAEnB,UAAM;AAAEK,kBAAF;AAAgBE,eAAhB;AAA2BD;AAA3B,QAA4C,KAAKF,KAAvD;AACA,UAAM;AAAErB;AAAF,QAAY,KAAKoC,KAAvB;AACA,wBACE,2DAAC,4CAAD,CAAO,QAAP,qBACE,2DAAC,qDAAD,qBACE,2DAAC,qDAAD,CAAO,OAAP,qBACE,2DAAC,qDAAD,CAAO,KAAP;AAAa,YAAM;AAAnB,gBADF,CADF,eAIE,2DAAC,qDAAD,CAAO,IAAP;AAAY,iBAAW;AAAvB,oBACE,2DAAC,uDAAD,OADF,CAJF,CADF,eASE,2DAAC,sDAAD;AACE,WAAK,EAAEnB,KADT;AAEE,gBAAU,EAAE,KAAKU;AAFnB,MATF,eAaE,2DAAC,sDAAD;AAAO,UAAI,EAAG,GAAE3B,KAAK,CAACiD,IAAK,MAA3B;AAAkC,eAAS,EAAEC,uDAAUA;AAAvD,MAbF,eAcE,2DAAC,kDAAD;AACE,aAAO,EAAE5B,YADX;AAEE,eAAS,EAAE,KAAKO,YAFlB;AAGE,aAAO,EAAEL;AAHX,OAKGD,YALH,CAdF,CADF;AAwBD;;AAzImD,C","file":"server.1e62689047ebec34219a.hot-update.js","sourcesContent":["import React from 'react';\nimport URLSearchParams from 'url-search-params';\nimport { Route } from 'react-router-dom';\nimport { Panel } from 'react-bootstrap';\n\nimport ItemFilter from './ItemFilter.jsx';\nimport ItemTable from './ItemTable.jsx';\nimport ItemDetail from './ItemDetail.jsx';\nimport graphQLFetch from './graphQLFetch.js';\nimport Toast from './Toast.jsx';\nimport store from './store.js';\n\nexport default class ItemList extends React.Component {\n  static async fetchData(match, search, showError) {\n    const params = new URLSearchParams(search);\n    const vars = {};\n    if (params.get('category')) vars.category = params.get('category');\n\n    const priceMin = parseFloat(params.get('priceMin'), 10);\n    if (!Number.isNaN(priceMin)) vars.priceMin = priceMin;\n    const priceMax = parseFloat(params.get('priceMax'), 10);\n    if (!Number.isNaN(priceMax)) vars.priceMax = priceMax;\n\n    const query = `query itemList(\n      $category: CategoryType\n      $priceMin: Float\n      $priceMax: Float\n    ) {\n      itemList(\n        category: $category\n        priceMin: $priceMin\n        priceMax: $priceMax\n      ) {\n        id name category image\n        due\n      }\n    }`;\n\n    const data = await graphQLFetch(query, vars, showError);\n    return data;\n  }\n\n  constructor() {\n    super();\n    const items = store.initialData ? store.initialData.itemList : null;\n    delete store.initialData;\n    this.state = {\n      items,\n      toastVisible: false,\n      toastMessage: '',\n      toastType: 'info',\n    };\n    this.closeItem = this.closeItem.bind(this);\n    this.deleteItem = this.deleteItem.bind(this);\n    this.showSuccess = this.showSuccess.bind(this);\n    this.showError = this.showError.bind(this);\n    this.dismissToast = this.dismissToast.bind(this);\n  }\n\n  componentDidMount() {\n    const { items } = this.state;\n    if (items == null) this.loadData();\n  }\n\n  componentDidUpdate(prevProps) {\n    const { location: { search: prevSearch } } = prevProps;\n    const { location: { search } } = this.props;\n    if (prevSearch !== search) {\n      this.loadData();\n    }\n  }\n\n  async loadData() {\n    const { location: { search } } = this.props;\n    const data = await ItemList.fetchData(null, search, this.showError);\n    if (data) {\n      this.setState({ items: data.itemList });\n    }\n  }\n\n  async deleteItem(index) {\n    const query = `mutation itemDelete($id: Int!) {\n      itemDelete(id: $id)\n    }`;\n    const { items } = this.state;\n    const { location: { pathname, search }, history } = this.props;\n    const { id } = items[index];\n    const data = await graphQLFetch(query, { id }, this.showError);\n    if (data && data.itemDelete) {\n      this.setState((prevState) => {\n        const newList = [...prevState.items];\n        if (pathname === `/items/${id}`) {\n          history.push({ pathname: '/items', search });\n        }\n        newList.splice(index, 1);\n        return { items: newList };\n      });\n      this.showSuccess(`Deleted item ${id} successfully.`);\n    } else {\n      this.loadData();\n    }\n  }\n\n  showSuccess(message) {\n    this.setState({\n      toastVisible: true, toastMessage: message, toastType: 'success',\n    });\n  }\n\n  showError(message) {\n    this.setState({\n      toastVisible: true, toastMessage: message, toastType: 'danger',\n    });\n  }\n\n  dismissToast() {\n    this.setState({ toastVisible: false });\n  }\n\n  render() {\n    const { items } = this.state;\n    if (items == null) return null;\n\n    const { toastVisible, toastType, toastMessage } = this.state;\n    const { match } = this.props;\n    return (\n      <React.Fragment>\n        <Panel>\n          <Panel.Heading>\n            <Panel.Title toggle>Filter</Panel.Title>\n          </Panel.Heading>\n          <Panel.Body collapsible>\n            <ItemFilter />\n          </Panel.Body>\n        </Panel>\n        <ItemTable\n          items={items}\n          deleteItem={this.deleteItem}\n        />\n        <Route path={`${match.path}/:id`} component={ItemDetail} />\n        <Toast\n          showing={toastVisible}\n          onDismiss={this.dismissToast}\n          bsStyle={toastType}\n        >\n          {toastMessage}\n        </Toast>\n      </React.Fragment>\n    );\n  }\n}\n"],"sourceRoot":""}